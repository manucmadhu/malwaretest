import pefile
import os

# def get_pe_info(file_path):
#     try:
#         pe = pefile.PE(file_path)
#         return {
#             "DOS Header": str(pe.DOS_HEADER),
#             "File Header": str(pe.FILE_HEADER),
#             "Optional Header": str(pe.OPTIONAL_HEADER),
#             "Sections": [str(section) for section in pe.sections]
#         }
#     except pefile.PEFormatError as e:
#         print(f"PEFormatError: {e}")
#         return {"error": "Not a valid PE file"}
#     except Exception as e:
#         print(f"Error: {e}")
#         return {"error": "An unexpected error occurred"}

def get_static_analysis(file_path):
    analysis_results = {}
    if os.path.exists(file_path):
        analysis_results.update(extract_pe_info(file_path))
    else:
        analysis_results["error"] = "File not found"
    return analysis_results
def extract_pe_info(file_path):
    try:
        # Open the file with pefile.PE
        pe = pefile.PE(file_path)
        info = {
            'entry_point': pe.OPTIONAL_HEADER.AddressOfEntryPoint,
            'image_base': pe.OPTIONAL_HEADER.ImageBase,
            'number_of_sections': pe.FILE_HEADER.NumberOfSections
            # Add more fields as needed
        }
        return info
    except Exception as e:
        return str(e)